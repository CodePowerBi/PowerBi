Metric_Base =
VAR s     = TRIM ( 'DiccMetricas'[metric] & "" )
VAR core  = IF ( LEFT ( s, 4 ) = "num_", MID ( s, 5, LEN ( s ) - 4 ), s )
VAR cnt   = LEN ( core ) - LEN ( SUBSTITUTE ( core, "_", "" ) )
VAR posLast =
    IF ( cnt > 0, FIND ( "¤", SUBSTITUTE ( core, "_", "¤", cnt ), 1, 0 ), 0 )
RETURN
IF ( cnt = 0,
     core,                               -- ej: "wroff"  -> base = "wroff"
     LEFT ( core, posLast - 1 )          -- ej: "ncl_ytd" -> base = "ncl"
)
