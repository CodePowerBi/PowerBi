Fecha_Marcada_CET =
VAR FechaMaxDatos =
    CALCULATE(
        MAX ( 'tabla_nueva_Cet'[fecha] ),
        FILTER(
            ALL ( 'tabla_nueva_Cet' ),
            'tabla_nueva_Cet'[valor] <> 0
        )
    )
VAR MesMax = MONTH(FechaMaxDatos)
VAR AnioMax = YEAR(FechaMaxDatos)
VAR Trimestre = INT((MesMax - 1) / 3) + 1
VAR TrimestrePrev = IF(Trimestre = 1, 4, Trimestre - 1)
VAR AnioPrev = IF(Trimestre = 1, AnioMax - 1, AnioMax)
VAR MesUltimoPrevTrim =
    SWITCH(TrimestrePrev, 1, 3, 2, 6, 3, 9, 4, 12)
VAR FechaObjetivo = DATE(AnioPrev, MesUltimoPrevTrim, 1)
RETURN
    IF('Dates'[Date] = FechaObjetivo, FechaObjetivo, BLANK())
