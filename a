SELECT
    MONTH(f.fecha) AS mes,
    d.concatenado_front,
    ROUND(SUM(CASE WHEN f.id_unit = 'GBUSA' THEN f.contravalor ELSE 0 END) / 1000, 2) AS GBUSA,
    ROUND(SUM(CASE WHEN f.id_unit = 'GBSBNA' THEN f.contravalor ELSE 0 END) / 1000, 2) AS GBSBNA
FROM
    usa_liquidez_front_vw f
INNER JOIN
    tablones_des_dicc_aux_fron_id_bsi d
    ON f.id_id_bsi = d.id_bsi_front
WHERE
    YEAR(f.fecha) = 2025
    AND MONTH(f.fecha) = 3
    AND f.currency = 'TOT'
GROUP BY
    MONTH(f.fecha),
    d.concatenado_front
ORDER BY
    d.concatenado_front;
