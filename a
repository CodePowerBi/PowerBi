Marcador_UltimoMesTrimAnterior =
VAR FechaReferencia =
    CALCULATE(
        MAX('TABLA_NUEVA_CET'[fecha]),
        FILTER(
            ALL('TABLA_NUEVA_CET'),
            'TABLA_NUEVA_CET'[Valor] <> 0
        )
    )

VAR MesMax = MONTH(FechaReferencia)
VAR AnioMax = YEAR(FechaReferencia)
VAR Trimestre = INT((MesMax - 1) / 3) + 1

VAR TrimestrePrev = IF(Trimestre = 1, 4, Trimestre - 1)
VAR AnioPrev = IF(Trimestre = 1, AnioMax - 1, AnioMax)

VAR MesUltimoPrevTrim =
    SWITCH(
        TrimestrePrev,
        1, 3,
        2, 6,
        3, 9,
        4, 12
    )

VAR FechaObjetivo = DATE(AnioPrev, MesUltimoPrevTrim, 1)

RETURN
    IF('Dates'[Date] = FechaObjetivo, FechaObjetivo, BLANK())
