3m =
VAR FechaObjetivo =
    EDATE ( liq1_ponderada[date], -3 )
RETURN
COALESCE (
    CALCULATE (
        MAX ( liq1_ponderada[amount] ),
        FILTER (
            liq1_ponderada,
            liq1_ponderada[date] = FechaObjetivo
                && liq1_ponderada[metrica_eng] = EARLIER ( liq1_ponderada[metrica_eng] )
                && liq1_ponderada[metrica_esp] = EARLIER ( liq1_ponderada[metrica_esp] )
                && liq1_ponderada[IMPORTANTE_CALCULATION_DATE] = "Correcto"
        )
    ),
    0
)
