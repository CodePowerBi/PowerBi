RankingTop10_-3M :=
VAR TablaRanking =
    ADDCOLUMNS (
        SUMMARIZE (
            ALLSELECTED ( 'pag7 nueva' ),
            'pag7 nueva'[CounterpartyName]         -- una fila por contraparte
        ),
        "__Amount_-3M", [Amount_-3M]               -- importe de -3M para cada una
    )
VAR ThisCP   = MAX ( 'pag7 nueva'[CounterpartyName] )
VAR ThisAmt  = [Amount_-3M]
VAR RankCalc =
    RANKX (
        TablaRanking,
        [__Amount_-3M],                            -- ordenamos por Amount_-3M
        ThisAmt,
        DESC,
        SKIP
    )
RETURN
IF (
    ISBLANK ( ThisAmt ),
    BLANK (),
    IF ( RankCalc <= 10, RankCalc, BLANK () )
)
