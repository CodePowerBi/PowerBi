Valor_UltMesUltTrim_Menos1Mes = 
VAR MaxFechaValida =
    CALCULATE(
        MAX( 'tablones_des_salida_buffer'[fecha] ),
        FILTER(
            ALL( 'tablones_des_salida_buffer' ),
            'tablones_des_salida_buffer'[valor] <> 0
        )
    )

VAR MesVal    = MONTH( MaxFechaValida )
VAR AnioVal   = YEAR(  MaxFechaValida )
VAR Trimestre = INT(( MesVal - 1 ) / 3) + 1

// Trimestre completo anterior
VAR TrimestrePrev = IF( Trimestre = 1, 4, Trimestre - 1 )
VAR AnioPrev      = IF( Trimestre = 1, AnioVal - 1, AnioVal )

// Último mes de ese trimestre previo
VAR MesFinalPrevTrim =
    SWITCH(
        TrimestrePrev,
        1, 3,   // Q1 → marzo
        2, 6,   // Q2 → junio
        3, 9,   // Q3 → septiembre
        4, 12   // Q4 → diciembre
    )

// Primer día de ese mes
VAR FechaInicioTrimPrev = DATE( AnioPrev, MesFinalPrevTrim, 1 )
// Y su último día
VAR FechaFinTrimPrev = EOMONTH( FechaInicioTrimPrev, 0 )

// Ahora restamos un mes completo
VAR FechaInicio = EDATE( FechaInicioTrimPrev, -1 )
VAR FechaFin    = EOMONTH( FechaInicio, 0 )

RETURN
IF(
    'tablones_des_salida_buffer'[fecha] >= FechaInicio &&
    'tablones_des_salida_buffer'[fecha] <= FechaFin,
    'tablones_des_salida_buffer'[valor],
    BLANK()
)
