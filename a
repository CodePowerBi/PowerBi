MesAñoUltMesTrimestre =
VAR Mes     = MONTH( Dates[Date] )
VAR Anyo    = YEAR( Dates[Date] )

// 1) Recupera la fecha máxima válida (mismo cálculo que tu medida)
VAR MaxFecha =
    CALCULATE(
        MAX( 'TABLA_NUEVA_CET'[fecha] ),
        FILTER(
            ALL( 'TABLA_NUEVA_CET' ),
            'TABLA_NUEVA_CET'[Valor] <> 0
        )
    )
VAR MesMax  = MONTH( MaxFecha )
VAR AnyoMax = YEAR(  MaxFecha )

RETURN
IF(
    // 2) Si es fin de trimestre...
    Mes IN { 3, 6, 9, 12 }
    //  …o si coincide con el mes-año de MaxFecha
    || ( Mes = MesMax && Anyo = AnyoMax ),
    
    // Formatea “mmm-yy” en minúsculas
    LOWER( FORMAT( Dates[Date], "mmm" ) )
      & "-"
      & RIGHT( FORMAT( Dates[Date], "yy" ), 2 ),
      
    // Resto de meses → guión
    "-"
)
