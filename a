Top10_por_mes_mrf_67 =
VAR Agregado =
    SUMMARIZECOLUMNS (
        'tablones_des mrf_plantilla_67'[counterparty_name],
        "fecha",
            DATE (
                YEAR ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                MONTH ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                1
            ),
        "amount_received",
            SUM ( 'tablones_des mrf_plantilla_67'[amount_received] )
    )
VAR ConRanking =
    ADDCOLUMNS (
        Agregado,
        "rk",
            VAR m = [fecha]
            RETURN RANKX ( FILTER ( Agregado, [fecha] = m ), [amount_received], , DESC, DENSE )
    )
RETURN
SELECTCOLUMNS (
    FILTER ( ConRanking, [rk] <= 10 ),
    "counterparty_name", [counterparty_name],
    "fecha",            [fecha],
    "amount_received",  [amount_received]
)
