–– 1) Primer día del último mes del último trimestre completo con datos
PrimerDia_UltimoMesUltTrim_Stress = 
VAR MaxFechaValida =
    CALCULATE(
        MAX( 'tablones_des_salida_escenario_stress'[fecha] ),
        FILTER(
            ALL( 'tablones_des_salida_escenario_stress' ),
            'tablones_des_salida_escenario_stress'[surplis_60_days_div_tc] <> 0
        )
    )
VAR MesVal   = MONTH( MaxFechaValida )
VAR AnioVal  = YEAR(  MaxFechaValida )
VAR Trime    = INT(( MesVal - 1 ) / 3) + 1

// Último mes de ese trimestre
VAR MesFinalTrim =
    SWITCH(
        Trime,
        1, 3,   // Q1 → marzo
        2, 6,   // Q2 → junio
        3, 9,   // Q3 → septiembre
        4, 12   // Q4 → diciembre
    )

RETURN
DATE( AnioVal, MesFinalTrim, 1 )
