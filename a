Top10_por_mes_mrf_67 :=
VAR Meses =
    SUMMARIZE (
        'tablones_des mrf_plantilla_67',
        "fecha",
            DATE (
                YEAR ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                MONTH ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                1
            )
    )
VAR Resultado =
    GENERATE (
        Meses,
        VAR m = [fecha]
        RETURN
            TOPN (
                10,
                SUMMARIZE (
                    FILTER (
                        'tablones_des mrf_plantilla_67',
                        DATE (
                            YEAR ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                            MONTH ( 'tablones_des mrf_plantilla_67'[effective_date] ),
                            1
                        ) = m
                    ),
                    'tablones_des mrf_plantilla_67'[counterparty_name],
                    "amount_received",
                        SUM ( 'tablones_des mrf_plantilla_67'[amount_received] )
                ),
                [amount_received], DESC
            )
    )
RETURN
SELECTCOLUMNS (
    Resultado,
    "counterparty_name", [counterparty_name],
    "fecha",            [fecha],
    "amount_received",  [amount_received]
)
